import{_ as Y,r as d,h as F,c as s,b as u,a as t,e as P,w as _,v as D,n as c,t as i,f as A,F as b,d as g,i as Z,j as tt,o as r}from"./index-NOuf9RQv.js";import"./axios-DoXh8n1i.js";import{S as C}from"./sweetalert2.esm.all-BU56eIIa.js";class et{deleteContract(v){return new Promise(p=>{p()})}getContracts(){return new Promise(v=>{v()})}createContract(v){return new Promise(p=>{p()})}getTenantApplications(){return new Promise(v=>{v()})}approveTenantApplication(v){return new Promise(p=>{p()})}denyTenantApplication(v){return new Promise(p=>{p()})}}const at={class:"container"},ot={key:0,class:"position-fixed start-0 w-100 h-100 d-flex justify-content-center align-items-center",style:{background:"rgba(0, 0, 0, 0.5)","z-index":"1050",top:"0px"}},nt={class:"modal-content",style:{"overflow-y":"auto",height:"auto","max-width":"880px"}},lt={class:"modal-body p-4"},st={class:"contenedor-campos",style:{gap:"10px !important"}},rt={class:"grupo-campos"},it={class:"campos-grid"},dt={class:"campo"},ut={key:0,class:"text-danger mt-1"},ct={class:"campo"},vt={key:0,class:"text-danger mt-1"},pt={class:"campo"},mt={key:0,class:"text-danger mt-1"},_t={class:"campo"},ft={key:0,class:"text-danger mt-1"},ht={class:"campo"},yt=["value"],bt={key:0,class:"text-danger mt-1"},gt={class:"campo"},Ct=["value"],kt={key:0,class:"text-danger mt-1"},Mt={class:"campo"},wt={key:0,class:"text-danger mt-1"},St={class:"modal-footer"},xt=["disabled"],Ft={class:"modal-content"},Pt={class:"modal-body"},Dt=["src"],At={class:"row seccion mt-4"},Ot={class:"col-12 d-flex justify-content-between align-items-center mb-4"},Tt={class:"col-12 mb-4"},Et={class:"row"},$t={class:"col-md-6 mb-3"},qt=["value"],Ut={class:"col-md-6 mb-3"},Vt=["value"],It={class:"col-12"},Lt={style:{"overflow-x":"auto"}},Rt={class:"table table-bordered table-striped table-hover align-middle text-center custom-big-table",style:{"border-radius":"25px",overflow:"hidden"}},Bt=["onClick"],zt=["onClick"],Nt={class:"col-12"},jt={class:"pagination"},Ht=["onClick"],q=10,Qt={__name:"contracts",setup(B){const v=new et,p=tt(),f=d((()=>{const o=[],e=["En curso","Terminado","Pendiente"],a=["FO-APTO-301","SE-APTO-201","SE-APTO-301","FO-PARQ-1"],m=["Laura G√≥mez","Carlos P√©rez","Mar√≠a Rodr√≠guez","Andr√©s L√≥pez"];for(let k=1;k<=25;k++)o.push({id:k,property_id:Math.floor(Math.random()*4)+1,user_id:Math.floor(Math.random()*4)+1,tenant_application_id:Math.floor(Math.random()*10)+1,start_date:`202${Math.floor(Math.random()*5)}-${String(Math.floor(Math.random()*12)+1).padStart(2,"0")}-${String(Math.floor(Math.random()*28)+1).padStart(2,"0")}`,end_date:`202${Math.floor(Math.random()*5)+3}-${String(Math.floor(Math.random()*12)+1).padStart(2,"0")}-${String(Math.floor(Math.random()*28)+1).padStart(2,"0")}`,monthly_amount:(Math.random()*3e6+1e6).toFixed(2),deposit_amount:(Math.random()*3e6+1e6).toFixed(2),status:e[Math.floor(Math.random()*3)],created_at:`${String(Math.floor(Math.random()*28)+1).padStart(2,"0")}/${String(Math.floor(Math.random()*12)+1).padStart(2,"0")}/2023`,contract_doc:"https://pdfobject.com/pdf/sample.pdf",property:{sku:a[Math.floor(Math.random()*a.length)]},users:{name:m[Math.floor(Math.random()*m.length)]}});return o})()),U=d([{id:1,sku:"FO-APTO-301"},{id:2,sku:"SE-APTO-201"},{id:3,sku:"SE-APTO-301"},{id:4,sku:"FO-PARQ-1"}]),z=d(Array.from({length:10},(o,e)=>({id:e+1,property_id:U.value[Math.floor(Math.random()*4)].sku,FinancialResponsible:[{full_name:["Laura","Carlos","Mar√≠a","Andr√©s"][Math.floor(Math.random()*4)]}]}))),M=d(""),w=d(""),h=d(1),V=F(()=>f.value.filter(o=>{const e=!M.value||o.property.sku===M.value,a=!w.value||o.status===w.value;return e&&a})),S=F(()=>Math.ceil(V.value.length/q)),N=F(()=>{const o=(h.value-1)*q;return V.value.slice(o,o+q)}),j=F(()=>[...new Set(f.value.map(o=>o.property.sku))]),H=["En curso","Terminado"],O=d(!1),T=d(!1),E=d(""),y=d(!1),l=d({start_date:"",end_date:"",monthly_amount:"",deposit_amount:"",tenant_application_id:"",property_id:"",contract_doc:null});async function Q(o){const e=await C.fire({title:"¬øEst√°s seguro?",text:"¬øDeseas terminar este contrato?",icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, terminar",cancelButtonText:"No, cancelar",reverseButtons:!0});y.value=!0,e.isConfirmed&&await v.deleteContract({id:o}).then(a=>{if(a.success){const m=f.value.findIndex(k=>k.id===o);m!==-1&&(f.value[m]=a.data),p.commit("setContracts",f.value)}else C.fire("Error","Hubo un error, intenta despues.","error")}).catch(a=>{console.log(a),C.fire("Error","Hubo un error, intenta despues.","error")}),y.value=!1}const n=d({}),G=()=>{n.value={};let o=!0;return l.value.start_date||(n.value.start_date="Fecha de inicio requerida",o=!1),l.value.end_date||(n.value.end_date="Fecha de fin requerida",o=!1),new Date(l.value.end_date)<=new Date(l.value.start_date)&&(n.value.end_date="La fecha de fin debe ser posterior a la fecha de inicio",o=!1),(!l.value.monthly_amount||l.value.monthly_amount<=0)&&(n.value.monthly_amount="Monto mensual inv√°lido",o=!1),(!l.value.deposit_amount||l.value.deposit_amount<=0)&&(n.value.deposit_amount="Dep√≥sito inv√°lido",o=!1),l.value.tenant_application_id||(n.value.tenant_application_id="Seleccione una solicitud",o=!1),l.value.property_id||(n.value.property_id="Seleccione un inmueble",o=!1),l.value.contract_doc||(n.value.contract_doc="Documento requerido",o=!1),o},J=o=>{const e=o.target.files[0];e&&e.type==="application/pdf"?l.value.contract_doc=URL.createObjectURL(e):n.value.contract_doc="Solo se permiten archivos PDF"},K=async()=>{G()&&(y.value=!0,await v.createContract({id}).then(o=>{o.success?(f.value.push(o.data),p.commit("setContracts",f.value),C.fire("¬°√âxito!","El contrato ha sido creado exitosamente.","success")):C.fire("Error","Hubo un error, intenta despues.","error")}).catch(o=>{console.log(o),C.fire("Error","Hubo un error, intenta despues.","error")}),x(),y.value=!1)},W=o=>{E.value=o,T.value=!0},x=()=>{O.value=!1,l.value={start_date:"",end_date:"",monthly_amount:"",deposit_amount:"",tenant_application_id:"",property_id:"",contract_doc:null},n.value={}},I=()=>{T.value=!1,E.value=""},L=o=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(o),R=o=>{const e={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(o).toLocaleDateString("es-CO",e)},X=o=>({"En curso":"bg-en-curso",Terminado:"bg-terminado"})[o],$=o=>{o>=1&&o<=S.value&&(h.value=o)};return(o,e)=>(r(),s("div",at,[y.value?(r(),s("div",ot,e[11]||(e[11]=[t("div",{class:"spinner-border text-light",role:"status"},[t("span",{class:"visually-hidden"})],-1)]))):u("",!0),O.value?(r(),s("div",{key:1,class:"modal",onClick:P(x,["self"])},[t("div",nt,[t("div",{class:"modal-header"},[e[12]||(e[12]=t("span",{class:"modal-title"},"üìù Crear Nuevo Contrato",-1)),t("button",{class:"close-button",onClick:x},"√ó")]),t("div",lt,[t("form",{onSubmit:P(K,["prevent"])},[t("div",null,[t("div",st,[t("div",rt,[t("div",it,[t("div",dt,[e[13]||(e[13]=t("label",{class:"etiqueta"},"Fecha de Inicio",-1)),_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.start_date=a),type:"date",class:c(["entrada",{"is-invalid":n.value.start_date}]),placeholder:"Fecha de Inicio"},null,2),[[D,l.value.start_date]]),n.value.start_date?(r(),s("div",ut,i(n.value.start_date),1)):u("",!0)]),t("div",ct,[e[14]||(e[14]=t("label",{class:"etiqueta"},"Fecha de Fin",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.end_date=a),type:"date",class:c(["entrada",{"is-invalid":n.value.end_date}]),placeholder:"Fecha de Fin"},null,2),[[D,l.value.end_date]]),n.value.end_date?(r(),s("div",vt,i(n.value.end_date),1)):u("",!0)]),t("div",pt,[e[15]||(e[15]=t("label",{class:"etiqueta"},"Monto Mensual (COP)",-1)),_(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.monthly_amount=a),type:"number",class:c(["entrada",{"is-invalid":n.value.monthly_amount}]),placeholder:"Monto Mensual"},null,2),[[D,l.value.monthly_amount]]),n.value.monthly_amount?(r(),s("div",mt,i(n.value.monthly_amount),1)):u("",!0)]),t("div",_t,[e[16]||(e[16]=t("label",{class:"etiqueta"},"Dep√≥sito (COP)",-1)),_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.deposit_amount=a),type:"number",class:c(["entrada",{"is-invalid":n.value.deposit_amount}]),placeholder:"Dep√≥sito"},null,2),[[D,l.value.deposit_amount]]),n.value.deposit_amount?(r(),s("div",ft,i(n.value.deposit_amount),1)):u("",!0)]),t("div",ht,[e[18]||(e[18]=t("label",{class:"etiqueta"},"Solicitud de Arrendamiento",-1)),_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.tenant_application_id=a),class:c(["entrada",{"is-invalid":n.value.tenant_application_id}])},[e[17]||(e[17]=t("option",{value:"",disabled:"",selected:""},"Seleccionar Solicitud",-1)),(r(!0),s(b,null,g(z.value,a=>(r(),s("option",{key:a.id,value:a.id},i(a.property_id)+" - "+i(a.FinancialResponsible[0].full_name),9,yt))),128))],2),[[A,l.value.tenant_application_id]]),n.value.tenant_application_id?(r(),s("div",bt,i(n.value.tenant_application_id),1)):u("",!0)]),t("div",gt,[e[20]||(e[20]=t("label",{class:"etiqueta"},"Inmueble",-1)),_(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.property_id=a),class:c(["entrada",{"is-invalid":n.value.property_id}])},[e[19]||(e[19]=t("option",{value:"",disabled:"",selected:""},"Seleccionar Inmueble",-1)),(r(!0),s(b,null,g(U.value,a=>(r(),s("option",{key:a.id,value:a.id},i(a.sku),9,Ct))),128))],2),[[A,l.value.property_id]]),n.value.property_id?(r(),s("div",kt,i(n.value.property_id),1)):u("",!0)]),t("div",Mt,[e[21]||(e[21]=t("label",{class:"etiqueta"},"Documento del Contrato (PDF)",-1)),t("input",{type:"file",onChange:J,accept:".pdf",class:c(["entrada",{"is-invalid":n.value.contract_doc}])},null,34),n.value.contract_doc?(r(),s("div",wt,i(n.value.contract_doc),1)):u("",!0)])])])])]),t("div",St,[t("button",{type:"button",class:"boton-secundario",onClick:x}," Cancelar "),t("button",{type:"submit",class:"boton-primario",disabled:y.value,style:{width:"auto"}},i(y.value?"Creando...":"Crear Contrato"),9,xt)])],32)])])])):u("",!0),T.value?(r(),s("div",{key:2,class:"modal",onClick:P(I,["self"])},[t("div",Ft,[t("div",{class:"modal-header"},[e[22]||(e[22]=t("span",{class:"modal-title"},"Documento del Contrato",-1)),t("button",{class:"close-button",onClick:I},"√ó")]),t("div",Pt,[t("iframe",{src:E.value,width:"100%",height:"100%",style:{border:"none"}},null,8,Dt)])])])):u("",!0),t("div",At,[t("div",Ot,[e[24]||(e[24]=t("h2",{class:"titulo-seccion",style:{margin:"0"}},"üìë Contratos",-1)),t("button",{class:"boton-primario",onClick:e[6]||(e[6]=a=>O.value=!0),style:{width:"auto"}},e[23]||(e[23]=[t("i",{class:"fas fa-plus",style:{"margin-right":"10px"}},null,-1),Z("Crear Contrato ")]))]),t("div",Tt,[t("div",Et,[t("div",$t,[_(t("select",{class:"entrada","onUpdate:modelValue":e[7]||(e[7]=a=>M.value=a),style:{"background-color":"#f8f5f0"}},[e[25]||(e[25]=t("option",{value:""},"Todos los Inmuebles",-1)),(r(!0),s(b,null,g(j.value,a=>(r(),s("option",{key:a,value:a},i(a),9,qt))),128))],512),[[A,M.value]])]),t("div",Ut,[_(t("select",{class:"entrada","onUpdate:modelValue":e[8]||(e[8]=a=>w.value=a),style:{"background-color":"#f8f5f0"}},[e[26]||(e[26]=t("option",{value:""},"Todos los Estados",-1)),(r(),s(b,null,g(H,a=>t("option",{key:a,value:a},i(a),9,Vt)),64))],512),[[A,w.value]])])])]),t("div",It,[t("div",Lt,[t("table",Rt,[e[28]||(e[28]=t("thead",{style:{"background-color":"#8f754f",color:"white"}},[t("tr",null,[t("th",null,"Inicio"),t("th",null,"Fin"),t("th",null,"Arriendo"),t("th",null,"Dep√≥sito"),t("th",null,"Inquilino"),t("th",null,"Inmueble"),t("th",null,"Status"),t("th",null,"Contrato"),t("th",null,"Fecha Creaci√≥n"),t("th")])],-1)),t("tbody",null,[(r(!0),s(b,null,g(N.value,a=>(r(),s("tr",{key:a.id},[t("td",null,i(R(a.start_date)),1),t("td",null,i(R(a.end_date)),1),t("td",null,i(L(a.monthly_amount)),1),t("td",null,i(L(a.deposit_amount)),1),t("td",null,i(a.users.name),1),t("td",null,i(a.property.sku),1),t("td",null,[t("span",{class:c(["badge",X(a.status)])},i(a.status),3)]),t("td",null,[a.contract_doc?(r(),s("a",{key:0,onClick:P(m=>W(a.contract_doc),["prevent"])},e[27]||(e[27]=[t("i",{class:"fas fa-file-pdf text-danger"},null,-1)]),8,Bt)):u("",!0)]),t("td",null,i(a.created_at),1),t("td",null,[t("i",{class:"fa-solid fa-trash",onClick:m=>Q(a.id)},null,8,zt)])]))),128))])])])]),t("div",Nt,[t("nav",null,[t("ul",jt,[t("li",{class:c(["page-item",{disabled:h.value===1}])},[t("a",{class:"page-link",onClick:e[9]||(e[9]=a=>$(h.value-1)),href:"#"},e[29]||(e[29]=[t("i",{class:"fa fa-arrow-left"},null,-1)]))],2),(r(!0),s(b,null,g(S.value,a=>(r(),s("li",{class:c(["page-item",{active:h.value===a}]),key:a},[t("a",{class:"page-link",onClick:m=>$(a),href:"#"},i(a),9,Ht)],2))),128)),t("li",{class:c(["page-item",{disabled:h.value===S.value||S.value===0}])},[t("a",{class:"page-link",onClick:e[10]||(e[10]=a=>$(h.value+1)),href:"#"},e[30]||(e[30]=[t("i",{class:"fa fa-arrow-right"},null,-1)]))],2)])])])])]))}},Xt=Y(Qt,[["__scopeId","data-v-04958f7b"]]);export{Xt as default};
